<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Jiayi's blog">
    <meta name="author" content="Jiayi">

    <title>表格中区域多选单元格的实现方法</title>

    <!-- Bootstrap Core CSS -->
    <link href="/styles/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/styles/custom.css" rel="stylesheet">
	
	<link href="/styles/markdown.css" rel="stylesheet">
	
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" id="collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Jiayi's Blog</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    <li>
                        <a href="/">Archive</a>
                    </li>
                    <li>
                        <a href="/">About</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="site-heading">
                        <h1>Understand the world</h1>
                        <hr class="small">
                        <span class="subheading">Step by step</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
					<div class="markdown-body">
						<h1 id="表格中区域多选单元格的实现方法">表格中区域多选单元格的实现方法</h1>
						<p class="post-meta"><span class="glyphicon glyphicon-time"></span> 2016-3-10 23:20</p>
						<hr>

						<p>最近因BI产品的要求，需要开发Web版的报表设计器，要做一个具有表格基本功能的工具，类似于Excel，其中遇到了多选区域的问题，花了些时间研究了研究Excel的规则，并按照规则在表格工具中实现。</p>

						<h2 id="区域多选规则">区域多选规则</h2>

						<p>区域多选单元格是表格中最基本的功能，选中一个单元格后，拖动鼠标到另一个单元格，就会计算出覆盖起始两个单元格的最小矩形，矩形内的所有单元格都为被选中状态，这个矩形就是选中区域。 <br>
						</p><center><img longdesc="./range-select.png" alt="range-select" title="" type="image/png" src="data:image/png;base64,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Y8fkyZODEUVFRRMnTty8ebPOOUazAoCYuNlplpaWbt269d577507d+5777339ttv6wQAeJXL1zSnTp26atWqJUuWZGRk6JDDNCsAiImbnSYA+I7LnebA06wAICZ0mgBgA50mANhA0QQAGzg9BwAb6DQBwAY6TQCwIe7qzVdxcXE4HNYAAMwVHx/f0NDQ3t6elpamQ72yTlqvJC8v70+zSEZtbW3Hjx/XDP1PMpItGXmZeRkJScq8jGQr9cEKryRKp5mfny+lVwMjBIPB6urq7u7uxMREHfK5UChERh5nXkZCkqqsrDQsI1mmhISE9PR0HeqVVTuvRErvH2aRjOg0PY6MfEGSGpydJnfPAcAG7p4DgA10mgBggyc6zebm5nURsqNDAOBJ7neaeXl5JSUl/4uorKzUUcdoVgAQE5c7zblz58r2yy+/bIrYvn27NQ4A3uRmpykn48eOHauvr09KStIh52lWABATNztNKZepqanXX3+9xgDgeW52msePH8/MzHz66acnReTn57e0tOicYzQrAIiJm51mR0fHiRMnZOfo0aOffPKJ7BQVFUVmAMCjXL4RJCoqKmQrJ+nV1dXhcHj//v3WOAB4kJtFc/To0boXIafqGRkZBw4c0BgAvMfNa5q33367nKFrcPGinKpLp3nPPfdo7AzNCgBi4man+fjjj8v2sccek+2pU6dKSkqmT5+enZ0dmQQAL3Kz00xNTa2oqPjss88mT54sDWZKSsqWLVt0zjGaFQDExOUbQQUFBUeOHNm6devevXvffvvtzMxMnQAAT3Kz07xs6tSp0nVq4DDNCgBi4omiOZA0KwCIicun5wDgL3SaAGADnSYA2ECnCQA20GkCgA10mgBgA50mANgQd/Xm64EHHjh79qwGRoiLi5Ky75CR95mXkTAvqeTk5F27drW3t6elpelQb6Kn/csvv/z5558amOLcuXPDhw/XwAhk5H3mZSQdlXlffe6HogkAvTKyo4qPj09NTdWgNxRNALCBG0EAYANFEwBsoGgCgA0UTQCwgaIJADZQNAHABoomANhA0QQAGyiaAGADRRMAbKBoAoANFE0A6LMhQ/4P1QmZ+u19iHUAAAAASUVORK5CYII=" class=""></center><p></p>

						<p>如图所示，选中B2单元格后拖拽至D4单元格，就会形成一个3x3的选中区域，共有9个单元格为被选中状态。 <br>
						如果单元格都是这样像砖块一样整齐的码在一起，只要获得起始单元格所在的行和列就可以计算出矩形选择区域。 <br>
						完成了区域多选功能后要做的就是合并单元格，当有了跨行或者跨列的合并单元格出现后，发现计算多选矩形区域的复杂度瞬间上升了几个数量级。 <br>
						</p><center><img longdesc="./merge-cell.png" alt="merge-cell" title="" type="image/png" src="data:image/png;base64,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" class=""></center><p></p>

						<p>如图所示，表格中有两个合并单元格（B2跨3行3列，E4跨3行），此时如果选中的起始单元格为B2和E2，按照之前最小矩形的计算方法，计算出的选择区域就是4x3的矩形，从B2到E4，此时虽然B2和E2都在选择的区域中，但E4单元格却只有1/3落入了选择区域中，这样的选择区域既无法显示选中状态也不便于对区域内的单元格进行操作，因此，区域多选的矩形框还必须要保证区域内的所有单元格都是全部落入区域内。 <br>
						选择B2和E2单元格后的选择区域应该是4x5的矩形，从B2到“E6”。 <br>
						</p><center><img longdesc="./marge-select.png" alt="marge-select" title="" type="image/png" src="data:image/png;base64,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" class=""></center><p></p>

						<p>至此可将表格区域多选的规则总结为如下3条：</p>

						<ol><li rel="1">选择区域必须覆盖起始单元格。</li>
						<li rel="2">选择区域内的单元格必须为全部落入。</li>
						<li rel="3">选择区域为满足以上两个条件的最小矩形。</li>
						</ol>

						<p>问题复杂性正式因为需要满足第二条，在上述的例子中，因为E4单元格的跨行原因，导致选择区域需要向下多选两行，然而多选中的区域中有可能会出现新的合并单元格导致选择区域需要继续扩大。 <br>
						如图所示，由于A6单元格横跨两列恰好一半落在第一扩大的区域中，导致选择区域需要继续扩大到5x5的矩形框。</p>

						<p></p><center><img longdesc="./marge-select2.png" alt="marge-select2" title="" type="image/png" src="data:image/png;base64,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" class=""></center><p></p>

						<h2 id="区域多选实现方法">区域多选实现方法</h2>

						<p>在介绍区域算法实现之前，我们先看一看合并单元格是如何产生的，因为问题变得复杂正是由于合并单元格的出现。 <br>
						合并单元格是将选中的多个单元格合并为一个单元格，将最左上角的单元格的内容作为最终大单元格的内容。 <br>
						</p><center><img longdesc="./marge-create.png" alt="marge-create" title="" type="image/png" src="data:image/png;base64,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" class=""></center><p></p>

						<p>如图所示，当实现3x3单元格的合并时，需要将B2单元格的colspan和rowspan属性均设置为3，同时将区域中剩余的8个设为隐藏。 <br>
						为了方便后面选择区域的计算，这里在合并单元格时加了一些特殊的处理： <br>
						1.被覆盖的单元格不是被删除，而是设为隐藏，这样遍历单元格的时候仍然可以将表格看作一个二维矩阵，而且做单元格拆分操作的时候只需要将隐藏的单元格再设为可见就行了。 <br>
						2.被合并的单元格中增加一个合并属性，如图所示，每个设置一组坐标（merge{row: XX, column: XX}），左上角的单元格设为（0，0），其余单元格根据与左上角单元格的行列差设置坐标。 <br>
						</p><center><img longdesc="./coordinate.png" alt="coordinate" title="" type="image/png" src="data:image/png;base64,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" class=""></center><p></p>

						<p>有了如上的铺垫，实现区域多选的方法就相对容易一些，基本思路如下： <br>
						1.先根据起始单元格的行和列计算出一个矩形区域。 <br>
						2.遍历上、左、右、下各边界上的单元格，如果发现有落入一般的单元格则需要将边界响应的扩大到该单元格全部落入。 <br>
						3.循环重复步骤2，直至矩形区域的边界不在扩大。 <br>
						循环遍历各边界按照上、左、右、下进行，方向按照下图所示。 <br>
						</p><center><img longdesc="./direction.png" alt="direction" title="" type="image/png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARoAAACVCAIAAAAIQKJUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAVMSURBVHhe7d27S2NLAMfxGHwEsbBQTDpfiHbapYwIdoJ2amchsbNUK2Onf4JYJJVgJ1iL6bRMJ4qvyiBapJDgC73jnmG5XhBMzs9zcuZ+P0V25giuZzdfZ8y6Y9PHx0cMgELc/grAN3ICZMgJkCEnQIacABlyAmTICZAhJ0CGnAAZcgJkyAmQISdAhpwAGXJCaG5ubuzIFeSE0BQKhbGxsWKxaOfRR04IU6lUGh8fn5mZcWOlIieEb39/f2RkZG1trVKp2EsR9REdmUzGftBwVDKZPD09tX/fEcR/bkdocrncxsaGNzYhZbPZpaUlM/CuRBGbPYQsnU7n8/lyuWzqinRLBqsTQlMsFhOJhMnJzqOPnAAZNnuADDkBMuQEyJATIENOgAw5ATLkBMiQEyBDToBM0N8Vsbi4eHFxYSdOaGtre35+thMnuHdHg4ODOzs7dvKbgs5pfHz86OjITpzAHTW+wO4onJweHh5eX1/tpYibn5/f3d01n87NJ3V7KeJcvaOWlpauri576ZeYnIKUyWTM4+3trTd1gHdHZ2dn3tQBrt5RAM86XooAZMgJkCEnQIacABlyAmTICZAhJ0CGnIAvFhYW7Kh25AR8USgU7Kh25ATI+M3Jz8oIOMZvTn5WRsAxbPYAGXICZMgJkCEnQIacABlyAmTICZAhJ0CGnAAZcgJkyAmQISdAhpwAGb+HKjc11fYeJiYm3t/f7QQIRDwePzw8LJfLqVTKXvperU/pLz6PgvWh1vfAocqN739+qLKfKIJenbwj/6+urt7e3uyliMtms9vb2y8vL62trfZSxLl6R83Nzf39/fbS91idwsTq1PgCW514KQKQISdAhpwAGXICZMgJkCEnQIacABlyAmTICZAhJ0CGnAAZcgJkyAmQISdAhpwAGXICZMgJkCEnQIacABlyAmTICZAhJ0CGnAAZcgJkyAmQCfpQZY78R/ACO/I/6Jy8M8ovLy/b29vtpYibn5/f3d29v7/v7u62lyLO1TuqVqsDAwP20vf85BTOZs9nw0BNJicnzWMQzzrze/hR63vgyP/Gx5H/dlQ7XooAZMgJkCEnQIacABlyAmTICZAhJ0CGnIBPJycnuT/M2BsUi0XvTT9HTsCn3t7era2tjY0NMzaPRmdnp/emnyMn4FMymZyenraTWCyTyYyOjtrJj5ETYK2srNhRLLa8vGxHtagnp1Kp5G0uDTP1Bmbr6b0ViCizHHkr0n9Wqp+rJ6fh4eG9vT1vf2mm5tFsOs3W03srEF3eAvXvZaom9eSUSCTy+byd/LG0tGSCthMgssyiZBaG2dlZO69RnV87pdPp1dVVb2zqqrtmoKGYJ/PR0VHda0P9L0Wsr6+bXZ8ZsDTBJX6+bKk/J2/Lx9IE/FV/TobZ8h0fH7M0AR5fORl1/FMX4Cq/OQH4i5wAGXICZMgJkCEnQMbvocq1mpqaenx8tBMn+DmDtzG5d0cdHR0HBwc/PKPcj3D+4AK4sYCdn58PDQ3ZiRPcuyNnc7q7u3Ps52hUq1VnfoiBx707isfjPT09dvI7XFvWgRDxUgQgQ06ADDkBMuQEyJATIENOgAw5ATLkBMiQE0Jzc3Pz9PRkJ04gJ4SmUCikUqm1tTXTlb0UceSEMFUqlc3Nzb6+vrm5uTp+AEzD+YiOTCZjP2g4anh4+Pr62v59RxDfAovQ5HI575h7I5lMZrPZqB+BymYPIUun0/l8vlwum7qifmYjqxNCY75YSiQSJic7jz5yAmTY7AEy5ATIkBMgQ06ADDkBMuQEyJATIENOgAw5ATLkBMiQEyASi/0DcwtEEwkP/BQAAAAASUVORK5CYII=" class=""></center><p></p>

						<p>1.遍历上边界 <br>
						遍历上边界时，如果单元格的merge.row不为0，说明上边界中有单元格落在了外面，需要扩大上边界，将上边界扩大merge.row即可。 <br>
						2.遍历左边界 <br>
						遍历左边界时，如果单元格的merge.column不为0，说明左边界中有单元格落在了外面，需要扩大左边界，将左边界扩大merge.column即可。 <br>
						3.遍历右边界 <br>
						遍历右边界时，如果单元格的merge.cow属性为0，则根据merge.column可以找到左上角单元格，根据左上角单元格的colspan计算当前单元格是否落在了边界外面，并相应的扩大右边界。 <br>
						4.遍历下边界 <br>
						遍历下边界时，如果单元格的merge.column属性为0，则根据merge.row可以找到左上角单元格，根据左上角单元格的rowspan计算当前单元格是否落在了边界外面，并相应的扩大下边界。</p>

						<p>根据如上所述方法，简单的代码实现如下：</p>

						<pre class="prettyprint hljs-dark"><code class="hljs stata">function getRange(startCell, endCell)<br>{<br>    <span class="hljs-comment">//Compute selection range</span><br>    <span class="hljs-keyword">var</span> <span class="hljs-keyword">range</span> = {<br>        startRow: Math.<span class="hljs-literal">min</span>(startCell.row, endCell.row),<br>        endRow: Math.<span class="hljs-literal">max</span>(startCell.row + startCell.rowspan - 1, <br>            endCell.row + endCell.rowspan - 1),<br>        startColumn: Math.<span class="hljs-literal">min</span>(startCell.column, endCell.column), <br>        endColumn: Math.<span class="hljs-literal">max</span>(startCell.column + startCell.columnspan - 1, <br>            endCell.column + endCell.columnSpan - 1)<br>    };<br><br>    <span class="hljs-keyword">var</span> rangeExpand = true;<br>    <span class="hljs-keyword">while</span>(rangeExpand)<br>    {<br>        rangeExpand = false;<br><br>        <span class="hljs-comment">//Top Edge</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">range</span>.startColumn ; i &lt;= <span class="hljs-keyword">range</span>.endColumn ;)<br>        {<br>            <span class="hljs-keyword">var</span> cell = cells[<span class="hljs-keyword">range</span>.startRow][i];<br>            <span class="hljs-keyword">if</span>(cell.<span class="hljs-keyword">merge</span> != null &amp;&amp; cell.<span class="hljs-keyword">merge</span>.row &gt; 0)<br>            {<br>                rangeExpand = true;<br>                <span class="hljs-keyword">range</span>.startRow -= cell.<span class="hljs-keyword">merge</span>.row;<br>                i += cells[<span class="hljs-keyword">range</span>.startRow][i - cell.<span class="hljs-keyword">merge</span>.column].columnspan;<br>            }<br>            <span class="hljs-keyword">else</span><br>            {<br>                i++;<br>            }<br>        }<br><br>        <span class="hljs-comment">//Left Edge</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">range</span>.startRow ; i &lt;= <span class="hljs-keyword">range</span>.endRow ;)<br>        {<br>            <span class="hljs-keyword">var</span> cell = cells[i][<span class="hljs-keyword">range</span>.startColumn];<br>            <span class="hljs-keyword">if</span>(cell.<span class="hljs-keyword">merge</span> != null &amp;&amp; cell.<span class="hljs-keyword">merge</span>.column &gt; 0)<br>            {<br>                rangeExpand = true;<br>                <span class="hljs-keyword">range</span>.startColumn -= cell.<span class="hljs-keyword">merge</span>.column;<br>                i += cells[i][<span class="hljs-keyword">range</span>.startColumn].rowspan;<br>            }<br>            <span class="hljs-keyword">else</span><br>            {<br>                i++;<br>            }<br>        }<br><br>        <span class="hljs-comment">//Right Edge</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">range</span>.startRow ; i &lt;= <span class="hljs-keyword">range</span>.endRow ;)<br>        {<br>            <span class="hljs-keyword">var</span> cell = cells[i][<span class="hljs-keyword">range</span>.endColumn];<br>            <span class="hljs-keyword">if</span>(cell.<span class="hljs-keyword">merge</span> != null)<br>            {<br>                <span class="hljs-keyword">var</span> mergeCell = cells[i][cell.column - cell.<span class="hljs-keyword">merge</span>.column];<br>                <span class="hljs-keyword">var</span> expandColumnCount = mergeCell.columnspan - cell.<span class="hljs-keyword">merge</span>.column - 1;<br>                <span class="hljs-keyword">if</span>(expandColumnCount &gt; 0)<br>                {<br>                    rangeExpand = true;<br>                    this.rangeSelection.endColumnIndex += outColumnCount;<br>                }<br>                i += mergeCell.rowspan;<br>            }<br>            <span class="hljs-keyword">else</span><br>            {<br>                i++;<br>            }<br>        }<br><br>        <span class="hljs-comment">//Bottom Edge</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">range</span>.startColumn ; i &lt;= <span class="hljs-keyword">range</span>.endColumn ;)<br>        {<br>            <span class="hljs-keyword">var</span> cell = cells[<span class="hljs-keyword">range</span>.endRow][i];<br>            <span class="hljs-keyword">if</span>(cell.<span class="hljs-keyword">merge</span> != null)<br>            {<br>                <span class="hljs-keyword">var</span> mergeCell = cells[cell.row - cell.<span class="hljs-keyword">merge</span>.row][i];<br>                <span class="hljs-keyword">var</span> expandRowCount = mergeCell.rowspan - cell.<span class="hljs-keyword">merge</span>.row - 1;<br>                <span class="hljs-keyword">if</span>(expandRowCount &gt; 0)<br>                {<br>                    rangeExpand = true;<br>                    <span class="hljs-keyword">range</span>.endRow += expandRowCount;<br>                }<br>                i += mergeCell.columnspan;<br>            }<br>            <span class="hljs-keyword">else</span><br>            {<br>                i++;<br>            }<br>        }<br>    }<br>}<br></code></pre>
					</div>
				</div>
            </div>
        </div>
    </article>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <p class="copyright text-muted">Copyright &copy; 2016 Jiayi </p>
                </div>
            </div>
        </div>
    </footer>
	
	<script src="/scripts/toggle.js"></script>

</body>

</html>
